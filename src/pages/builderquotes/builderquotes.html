<ion-header>
  <ion-navbar color="primary">
    <ion-toolbar>
      <ion-title>Quotation</ion-title>
    </ion-toolbar>
  </ion-navbar>
</ion-header>
<ion-content padding>
  <!--   <div class="logo">
    <img src="../../assets/imgs/logo.png" class="thumb" alt="">
  </div> -->
  <form [formGroup]="quotesForm">
    <ion-item>
      <ion-label floating>Expiry date</ion-label>
      <ion-datetime formControlName="expiry" displayFormat="DD-MMM-YYYY" [min]="maxDate" max="2022-01-01"
        pickerFormat="DD MMM YYYY" [(ngModel)]="quotes.expiry"></ion-datetime>
    </ion-item>
    <div class="error" *ngFor="let validate of validation_messages.expiry">
      <div class="messages"
        *ngIf="quotesForm.get('expiry').hasError(validate.type) && (quotesForm.get('expiry').dirty || quotesForm.get('expiry').touched)">
        {{validate.message}}
      </div>
    </div>
    <ion-item>
      <ion-label floating>Builder Name</ion-label>
      <ion-input type="text" formControlName="fullName" name="fullName" [(ngModel)]="quotes.fullName" ngDefaultControl>
      </ion-input>
    </ion-item>
    <!-- <div class="error" *ngFor="let validate of validation_messages.fullName">
               <div class="messages" *ngIf="profileForm.get('fullName').hasError(validate.type) && (profileForm.get('fullName').dirty || profileForm.get('fullName').touched)">
                 {{validate.message}}
               </div>
               </div> -->
    <!-- <ion-item color="light"  style="color: #fff;">
            <input formControlName="address" ngx-google-places-autocomplete [options]='options' #placesRef="ngx-places" (onAddressChange)="handleAddressChange($event)" style="border: none; width: 100%"/>
            </ion-item> -->
    <ion-item>
      <ion-label floating>Builder Address</ion-label>
      <ion-input formControlName="address" [(ngModel)]="quotes.address"></ion-input>
    </ion-item>
    <div class="error" *ngFor="let validate of validation_messages.address">
      <div class="messages"
        *ngIf="quotesForm.get('address').hasError(validate.type) && (quotesForm.get('address').dirty || quotesForm.get('address').touched)">
        {{validate.message}}
      </div>
    </div>
    <div class="error" *ngFor="let validate of validation_messages.address">
      <div class="messages"
        *ngIf="quotesForm.get('address').hasError(validate.type) && (quotesForm.get('address').dirty || quotesForm.get('address').touched)">
        {{validate.message}}
      </div>
    </div>

    <!-- Overall house -->

    <div class="houseOverall">
      <div class="header">
        <h5>Overall House</h5>
      </div>
      <div class="parent">
        <div class="price">

          <p>Price p/m2</p>
          <p><strong>{{quotes.price  | currency:'&#82;'}}</strong></p>
        </div>
        <ion-item>
          <ion-label floating>m2</ion-label>
          <ion-input type="number" formControlName="dimension" [(ngModel)]="quotes.meter"></ion-input>

        </ion-item>
        
        <ion-item>
          <ion-label floating>Discount</ion-label>
          <ion-input type="number" formControlName="dimension" [(ngModel)]="quotes.discount"></ion-input>
        </ion-item>
        <p>%</p>
      </div>

    </div>


    <div *ngFor="let item of extras; let i=index;">
      <hr>
      <h5>{{item.item}}</h5>
      <hr>
      <div class="parent">
        <div class="price">
          <ion-item>
            <ion-label floating>Price</ion-label>
            <ion-input type="number" formControlName="dimension" [(ngModel)]="extras[i].data.price" (ngModelChange)="onChange($event)"></ion-input>
          </ion-item>
        </div>
        <div class="quantity">
          <div class="header">
            <ion-label>Quantity</ion-label>
          </div>
          <div class="quantityCount">
            <div class="typ2"><button class="btn-border" ion-fab mini color="light" (click)="childMinus(item,i)">
                <ion-icon ios="ios-remove" md="md-remove"></ion-icon>
              </button></div>
            <div class="typ3" style="padding: 12px">{{extras[i].data.quantity}}</div>
            <div class="typ4"> <button class="btn-border" ion-fab mini (click)="childPlus(item, i)">
                <ion-icon ios="ios-add" md="md-add"></ion-icon>
              </button></div>
          </div>
        </div>
      </div>
    </div>
    <div class="calculations">
      <!-- subtotal and discount -->
      <div class="accumulatedAmount">
        <div class="subtotal">
          <p><strong>Subtotal</strong></p>
          <p><strong>{{value - (value * quotes.discountAmount/100)  | currency:'&#82;'}}</strong></p>
        </div>
        <div class="discount">
          <p><strong>Discount(%)</strong></p>
          <ion-item>
            <ion-input formControlName="dimension" [(ngModel)]="quotes.discountAmount"></ion-input>
          </ion-item>
          <p>%</p>
        </div>
        <div class="discountAmount" style="color: grey">
          <p><strong>Discount Amount</strong></p>
          <p><strong>{{ (value) * quotes.discountAmount/100 | currency:'&#82;' }}</strong></p>
        </div>
      </div>
    </div>
    <p>Total price: {{((quotes.price * quotes.meter) - (quotes.price * quotes.meter) * (quotes.discount/100)) + (value) * quotes.discountAmount/100 | currency:'&#82;'}}</p>
  </form>
</ion-content>
<ion-footer>
  <ion-toolbar padding style="display: flex">

    <button ion-button class="btn-proceed" block (click)="createPdf()" color="primary">Send Quotation</button>
    <button ion-button class="btn-proceed" block (click)="test()" color="primary">Download</button>
  </ion-toolbar>
</ion-footer>